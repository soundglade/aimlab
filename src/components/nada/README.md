# Nada - Guided Meditation Generator

Nada is an experimental tool inside AIM Lab that allows users to synthesize guided meditations from text-based meditation scripts (likely generated by ChatGPT or other LLMs). It transforms text-based meditation scripts into formatted and narrated audio meditations.

## Features

- **Script Formatting**: Converts raw meditation scripts into structured, formatted content
- **Voice Selection**: Choose from a variety of voice options for narration
- **Audio Synthesis**: Generates high-quality audio narration of meditation scripts
- **Playback**: Listen to synthesized meditations
- **Session Management**: Save and retrieve meditation sessions
- **Private Mode**: Option to use the application without saving any data

## Architecture

### Core Components

1. **NadaPage (`NadaPage.tsx`)**:

   - Main container component that manages application state and workflow
   - Handles session management and persistence
   - Coordinates the different meditation creation steps

2. **PracticeSetup (`PracticeSetup.tsx`)**:

   - Handles input of meditation scripts
   - Provides private vs. saved session options

3. **FormattedMeditation (`FormattedMeditation.tsx`)**:

   - Displays the formatted meditation script for review

4. **VoiceSelection (`VoiceSelection.tsx`)**:

   - Interface for selecting voice options with basic and advanced customization

5. **SynthesisProgress (`SynthesisProgress.tsx`)**:

   - Manages audio synthesis process with progress tracking

6. **MeditationPlayer (`MeditationPlayer.tsx`)**:
   - Provides controls for playing completed meditations

### Service & Hook Architecture

1. **useSynthesis (`useSynthesis.ts`)**:

   - Custom hook that manages the synthesis process
   - Handles progress tracking and error handling

2. **synthesisService (`synthesisService.ts`)**:
   - Service for audio synthesis API communication
   - Processes streaming responses and audio data

### Storage System

The application uses two types of storage systems:

1. **Session Storage**:

   - Persists meditation session data and state
   - Has both persistent and ephemeral (private) modes

2. **File Storage**:
   - Manages audio files generated during synthesis
   - Supports both persistent and ephemeral storage options

### Backend API Interactions

The frontend communicates with two main API endpoints:

1. **Script Formatting** (`/api/format-meditation-script`):

   - Transforms raw scripts into structured formats
   - Identifies speech sections, headings, pauses, sound cues, etc.

2. **Audio Synthesis** (`/api/synthesize-meditation`):
   - Converts formatted scripts into spoken audio
   - Streams audio data for real-time playback during synthesis

### Session Flow

1. **Input** (`PracticeSetup`): Enter meditation script
2. **Review** (`FormattedMeditation`): Review formatted content
3. **Voice** (`VoiceSelection`): Select voice options
4. **Synthesis** (`SynthesisProgress`): Generate audio with progress tracking
5. **Player** (`MeditationPlayer`): Play completed meditation

### Routing

- `/nada`: New meditation sessions (standard mode)
- `/nada/[id]`: Access saved meditation sessions
- `/nada/private`: New private meditation sessions
- `/nada/private/[id]`: Access private sessions (no data persistence)

## Development Guidelines

- Follow the AIM Lab Frontend Conventions for code style
- Use functional programming patterns and React hooks
- Maintain the calm, mindful aesthetic throughout the UI
- Ensure responsive design for all screen sizes
